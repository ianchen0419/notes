# EXCEL轉檔日文CSV方法

csv，是一種逗點分隔形式的文字檔。比方說在excel中一個表格長這樣。

|這是|一個|表格|
|----|---|---|

這一段資訊轉成csv後就會變成

```
"這是","一個","表格"
```

轉成csv後，文件會大幅輕量化，所以很適合資訊量很多的文件使用。  
而excel支援內建csv存檔格式，所以要存csv也很方便（存檔時選擇存成csv格式）。  
BUT!!  
因為excel不支援utf-8格式。  
如果文件裡面有日文，轉檔出來的csv會變成亂碼。  
一開始是安裝OpenOffice轉檔解決問題，但公司的acer win10毎次用OpenOffice開.xlsx都會出現重複字問題。  
比方說某一格是

```
コード
```
用OpenOffice開啟後會變成

```
コードコードコードコードコードコードコード
```

毎次開檔案還要一格一格檢査實在很麻煩（眼睛都要花了…）  
所以我後來研究出用access轉檔的方法！既可以解決重複字問題也可以快速轉檔。

## 條件限制

1. 需安裝access
2. 原始文件儲存格內不能有換行資訊，像是這樣

|這是<br>換行部分|一個|表格|
|----|---|---|

如上，最左邊第一格，有換行資訊。  
如果取消換行也沒差的話可以用先用excel取代功能，將換行資訊（輸入`Ctrl`+`J`）取代為無。

## excel轉檔csv步驟

①準備好excel文件，確認儲存格內沒有換行資訊。

②`Ctrl`+`A`全選，格式改為「文字」，存檔，關閉excel。

![](https://raw.githubusercontent.com/ianchen0419/notes/master/img/EXCEL%E8%BD%89%E6%AA%94%E6%97%A5%E6%96%87CSV%E6%96%B9%E6%B3%95/01.png)

③找到剛剛存好的xlsx檔案，按右鍵「開啟檔案」，「選擇其他應用程式」，「Access」

④出現這個視窗。甚麼都不要設定一直按「下一步」，「完成」
![](https://raw.githubusercontent.com/ianchen0419/notes/master/img/EXCEL%E8%BD%89%E6%AA%94%E6%97%A5%E6%96%87CSV%E6%96%B9%E6%B3%95/02.png)

⑤點選標籤「外部資料」，「匯出－文字檔」 【快速鍵：`Alt` + `X` + `T`】

![](https://raw.githubusercontent.com/ianchen0419/notes/master/img/EXCEL%E8%BD%89%E6%AA%94%E6%97%A5%E6%96%87CSV%E6%96%B9%E6%B3%95/03.png)

⑥接著出現匯出視窗，指定好儲存位置後按確定（中間的指定匯出選項不用勾）

⑦匯出格式選「分欄字元」，按右下角的進階【快速鍵：`V`】

⑧語言選「全部」，字碼頁選「日文(Shift-JIS)」  
確認最上面的欄位分隔符號是`,`，文字辨識符號是`"`

![](https://raw.githubusercontent.com/ianchen0419/notes/master/img/EXCEL%E8%BD%89%E6%AA%94%E6%97%A5%E6%96%87CSV%E6%96%B9%E6%B3%95/04.png)

⑨然後一直按下一步按到完成，結束，關掉Access，接著用excel確認看看剛剛做好的檔案

## excel開啟csv步驟

轉換成csv後，因為不好閱覽了，所以要檢查文件有沒有錯也不方便  
這時還是會使用EXCEL開啟做好的csv檔案查看  
但要注意**只能看，不能存**  
畢竟只要一存，日文字又會變回亂碼了

1. 開一個新的excel
2. 標籤「資料」，取得外部資料「從文字檔」
3. 原始資料類型「分隔符號」，檔案原始格式「日文(Shift-JIS)」，按下一步
4. 分隔符號「逗點」打勾，按下一步，按完成
5. 打開後檢査完畢，不要存檔直接關掉（如果在這裡存檔的話會變亂碼）

